<!DOCTYPE html>
<html lang="zh-TW">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title> æ›œæ—¥ç¾½çƒåœ˜ - æ˜Ÿéš›è£œçµ¦æ¯è‰¦ </title>
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  /* æ·±è‰²åŸºåº• */
Â  Â  Â  Â  Â  Â  --bg-main: #0f172a;
Â  Â  Â  Â  Â  Â  --bg-card: #1e293b;
Â  Â  Â  Â  Â  Â  --bg-input: #334155;
Â  Â  Â  Â  Â  Â  --text-primary: #f1f5f9;
Â  Â  Â  Â  Â  Â  --text-secondary: #94a3b8;
Â  Â  Â  Â  Â  Â  --accent: #38bdf8;
Â  Â  Â  Â  Â  Â  --border: #475569;

Â  Â  Â  Â  Â  Â  /* ä¸ƒæ›œæ—¥å…‰è­œ (Day of Week Colors) */
Â  Â  Â  Â  Â  Â  --d-1: #3b82f6; /* Mon: è— */
Â  Â  Â  Â  Â  Â  --d-2: #2dd4bf; /* Tue: é’ */
Â  Â  Â  Â  Â  Â  --d-3: #a855f7; /* Wed: ç´« */
Â  Â  Â  Â  Â  Â  --d-4: #f97316; /* Thu: æ©˜ */
Â  Â  Â  Â  Â  Â  --d-5: #ec4899; /* Fri: ç²‰ */
Â  Â  Â  Â  Â  Â  --d-6: #ef4444; /* Sat: ç´… */
Â  Â  Â  Â  Â  Â  --d-0: #eab308; /* Sun: é»ƒ */
Â  Â  Â  Â  Â  Â  --d-temp: #94a3b8; /* Temp: ç° */

Â  Â  Â  Â  Â  Â  /* ç‹€æ…‹ç‡ˆ */
Â  Â  Â  Â  Â  Â  --st-green-bg: rgba(16, 185, 129, 0.2); --st-green-text: #34d399;
Â  Â  Â  Â  Â  Â  --st-yellow-bg: rgba(245, 158, 11, 0.2); --st-yellow-text: #fbbf24;
Â  Â  Â  Â  Â  Â  --st-red-bg: rgba(239, 68, 68, 0.2);Â  Â  --st-red-text: #f87171;
Â  Â  Â  Â  }

Â  Â  Â  Â  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
Â  Â  Â  Â  body {Â 
Â  Â  Â  Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
Â  Â  Â  Â  Â  Â  background-color: var(--bg-main); color: var(--text-primary);
Â  Â  Â  Â  Â  Â  margin: 0; padding: 15px; padding-bottom: 140px;
Â  Â  Â  Â  }

Â  Â  Â  Â  h1 { text-align: center; margin-bottom: 20px; font-size: 1.4rem; font-weight: 800; letter-spacing: 1px; color: var(--text-primary); }
Â  Â  Â  Â  h1 span { color: var(--accent); }

Â  Â  Â  Â  .card {Â 
Â  Â  Â  Â  Â  Â  background: var(--bg-card); border-radius: 16px; padding: 18px;Â 
Â  Â  Â  Â  Â  Â  margin-bottom: 20px; border: 1px solid var(--border);
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px rgba(0,0,0,0.3);
Â  Â  Â  Â  }

Â  Â  Â  Â  h2 {Â 
Â  Â  Â  Â  Â  Â  font-size: 1rem; margin: 0 0 15px 0; color: var(--text-secondary);Â 
Â  Â  Â  Â  Â  Â  font-weight: 600; display: flex; align-items: center; justify-content: space-between;
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid var(--border); padding-bottom: 8px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* æ—¥æœŸé¡¯ç¤º */
Â  Â  Â  Â  .date-display {
Â  Â  Â  Â  Â  Â  background: rgba(56, 189, 248, 0.1); color: var(--accent);Â 
Â  Â  Â  Â  Â  Â  padding: 10px; text-align: center; font-weight: 700; border-radius: 10px; margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  border: 1px solid rgba(56, 189, 248, 0.2);
Â  Â  Â  Â  }
Â  Â  Â  Â  input[type="date"] {
Â  Â  Â  Â  Â  Â  width: 100%; padding: 12px; background: var(--bg-input);Â 
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border); border-radius: 10px;Â 
Â  Â  Â  Â  Â  Â  color: white; font-size: 1rem; color-scheme: dark; outline: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* å ´åœ°æŒ‰éˆ• */
Â  Â  Â  Â  .venue-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
Â  Â  Â  Â  .venue-btn {Â 
Â  Â  Â  Â  Â  Â  background: var(--bg-main); border: 1px solid var(--border);
Â  Â  Â  Â  Â  Â  padding: 15px 5px; border-radius: 12px; cursor: pointer; text-align: center; color: var(--text-secondary);
Â  Â  Â  Â  Â  Â  transition: 0.2s; position: relative; overflow: hidden;
Â  Â  Â  Â  Â  Â  border-left-width: 5px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .venue-btn strong { display: block; font-size: 1rem; margin-bottom: 4px; color: var(--text-primary); }
Â  Â  Â  Â  .venue-btn span { font-size: 0.75rem; opacity: 0.7; }
Â  Â  Â  Â  .venue-btn.active { background: var(--bg-input); box-shadow: inset 0 0 15px rgba(0,0,0,0.5); border-color: var(--accent); border-left-width: 5px; }
Â  Â  Â  Â  .venue-btn.active strong { color: var(--accent); }

Â  Â  Â  Â  /* æ›œæ—¥é¡è‰² */
Â  Â  Â  Â  .day-1 { border-left-color: var(--d-1); } .day-1.active { border-color: var(--d-1); color: var(--d-1); }
Â  Â  Â  Â  .day-2 { border-left-color: var(--d-2); } .day-2.active { border-color: var(--d-2); color: var(--d-2); }
Â  Â  Â  Â  .day-3 { border-left-color: var(--d-3); } .day-3.active { border-color: var(--d-3); color: var(--d-3); }
Â  Â  Â  Â  .day-4 { border-left-color: var(--d-4); } .day-4.active { border-color: var(--d-4); color: var(--d-4); }
Â  Â  Â  Â  .day-5 { border-left-color: var(--d-5); } .day-5.active { border-color: var(--d-5); color: var(--d-5); }
Â  Â  Â  Â  .day-6 { border-left-color: var(--d-6); } .day-6.active { border-color: var(--d-6); color: var(--d-6); }
Â  Â  Â  Â  .day-0 { border-left-color: var(--d-0); } .day-0.active { border-color: var(--d-0); color: var(--d-0); }
Â  Â  Â  Â  .day-temp { border-left-color: var(--d-temp); }

Â  Â  Â  Â  /* å¾®èª¿é¢æ¿ */
Â  Â  Â  Â  #venueAdjustPanel, #addVenueForm { margin-top: 15px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 12px; border: 1px solid var(--border); display: none; }
Â  Â  Â  Â  #addVenueForm { background: var(--bg-input); }
Â  Â  Â  Â  .adjust-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
Â  Â  Â  Â  .adjust-title { font-weight: bold; color: var(--accent); font-size: 1.1rem; }
Â  Â  Â  Â  .btn-toggle-edit {Â 
Â  Â  Â  Â  Â  Â  background: transparent; border: 1px solid var(--text-secondary); color: var(--text-secondary);
Â  Â  Â  Â  Â  Â  padding: 5px 10px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; transition: 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-toggle-edit.active { background: var(--bg-input); color: var(--accent); border-color: var(--accent); }
Â  Â  Â  Â  #adjustContent { display: none; margin-top: 15px; padding-top: 15px; border-top: 1px dashed var(--border); }
Â  Â  Â  Â  select.form-select {
Â  Â  Â  Â  Â  Â  background-color: var(--bg-input); color: white; border: 1px solid var(--border); border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 8px 12px; font-size: 1rem; width: 120px; text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .adjust-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
Â  Â  Â  Â  .manage-actions { display: flex; gap: 8px; margin-top: 15px; padding-top: 10px; border-top: 1px dashed var(--border); }
Â  Â  Â  Â  .btn-action { flex: 1; padding: 8px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; border: none; font-weight: bold; }
Â  Â  Â  Â  .btn-update { background: rgba(16, 185, 129, 0.2); color: var(--success); border: 1px solid var(--success); }
Â  Â  Â  Â  .btn-delete { background: rgba(239, 68, 68, 0.2); color: var(--danger); border: 1px solid var(--danger); }
Â  Â  Â  Â  .form-input { width: 100%; padding: 10px; margin-bottom: 10px; background: var(--bg-main); border: 1px solid var(--border); color: white; border-radius: 8px; }

Â  Â  Â  Â  /* çƒç¨® */
Â  Â  Â  Â  .ball-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px; }
Â  Â  Â  Â  .ball-btn { background: var(--bg-main); border: 1px solid var(--border); color: var(--text-secondary); padding: 14px; text-align: center; cursor: pointer; border-radius: 12px; position: relative; }
Â  Â  Â  Â  .ball-btn.active { background: var(--bg-input); color: var(--accent); border-color: var(--accent); }
Â  Â  Â  Â  .ball-del-btn { position: absolute; top: -5px; right: -5px; width: 22px; height: 22px; background: var(--danger); color: white; border-radius: 50%; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; z-index: 2; border: 2px solid var(--bg-card); }
Â  Â  Â  Â  .edit-toggle { font-size: 0.8rem; color: var(--accent); cursor: pointer; text-decoration: underline; }

Â  Â  Â  Â  .input-row { display: flex; align-items: center; gap: 10px; margin-top: 20px; background: var(--bg-main); padding: 10px; border-radius: 12px; border: 1px solid var(--border); }
Â  Â  Â  Â  input[type="number"] { flex: 1; padding: 10px; border: none; background: transparent; font-size: 1.3rem; text-align: center; color: white; }
Â  Â  Â  Â  .adj-btn { width: 40px; height: 40px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 10px; color: white; cursor: pointer; font-size: 1.2rem; }
Â  Â  Â  Â  .btn-save { width: 100%; padding: 16px; margin-top: 20px; background: var(--accent); color: #0f172a; border: none; border-radius: 14px; font-size: 1.1rem; font-weight: 800; cursor: pointer; }

Â  Â  Â  Â  /* æ­·å²å€å¡Š */
Â  Â  Â  Â  .venue-group {Â 
Â  Â  Â  Â  Â  Â  margin-top: 25px; background: var(--bg-main);Â 
Â  Â  Â  Â  Â  Â  border-radius: 14px; overflow: hidden;Â 
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border);Â 
Â  Â  Â  Â  Â  Â  border-left-width: 6px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .group-header { padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; background: var(--bg-input); }
Â  Â  Â  Â  .gh-title { font-size: 1.1rem; font-weight: 800; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* æ›œæ—¥é¡è‰²é€£å‹• */
Â  Â  Â  Â  .day-1 { border-left-color: var(--d-1); } .day-1 .gh-title { color: var(--d-1); }
Â  Â  Â  Â  .day-2 { border-left-color: var(--d-2); } .day-2 .gh-title { color: var(--d-2); }
Â  Â  Â  Â  .day-3 { border-left-color: var(--d-3); } .day-3 .gh-title { color: var(--d-3); }
Â  Â  Â  Â  .day-4 { border-left-color: var(--d-4); } .day-4 .gh-title { color: var(--d-4); }
Â  Â  Â  Â  .day-5 { border-left-color: var(--d-5); } .day-5 .gh-title { color: var(--d-5); }
Â  Â  Â  Â  .day-6 { border-left-color: var(--d-6); } .day-6 .gh-title { color: var(--d-6); }
Â  Â  Â  Â  .day-0 { border-left-color: var(--d-0); } .day-0 .gh-title { color: var(--d-0); }
Â  Â  Â  Â  .day-temp { border-left-color: var(--d-temp); } .day-temp .gh-title { color: var(--d-temp); }

Â  Â  Â  Â  /* æœˆåº¦æˆ°æƒ…å¡ç‰‡ (æ©«å‘æ²å‹•) */
Â  Â  Â  Â  .month-dashboard {
Â  Â  Â  Â  Â  Â  display: flex; gap: 10px; padding: 10px; overflow-x: auto;
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.2); border-bottom: 1px solid var(--border);
Â  Â  Â  Â  }
Â  Â  Â  Â  .month-card {
Â  Â  Â  Â  Â  Â  min-width: 130px; background: rgba(255,255,255,0.03);Â 
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border); border-radius: 10px; padding: 10px;
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; gap: 4px;
Â  Â  Â  Â  Â  Â  border-top: 3px solid transparent; /* é ç•™ä¸Šæ–¹è‰²æ¢ */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* æœˆå¡é…è‰²é€£å‹• */
Â  Â  Â  Â  .day-1 .month-card { border-top-color: var(--d-1); }
Â  Â  Â  Â  .day-2 .month-card { border-top-color: var(--d-2); }
Â  Â  Â  Â  .day-3 .month-card { border-top-color: var(--d-3); }
Â  Â  Â  Â  .day-4 .month-card { border-top-color: var(--d-4); }
Â  Â  Â  Â  .day-5 .month-card { border-top-color: var(--d-5); }
Â  Â  Â  Â  .day-6 .month-card { border-top-color: var(--d-6); }
Â  Â  Â  Â  .day-0 .month-card { border-top-color: var(--d-0); }

Â  Â  Â  Â  .mc-header { font-size: 0.85rem; font-weight: bold; color: var(--text-primary); border-bottom: 1px dashed var(--border); padding-bottom: 5px; margin-bottom: 5px; text-align: center; }
Â  Â  Â  Â  .mc-row { display: flex; justify-content: space-between; font-size: 0.75rem; }
Â  Â  Â  Â  .mc-label { color: var(--text-secondary); }
Â  Â  Â  Â  .mc-val { font-weight: bold; color: var(--text-primary); }

Â  Â  Â  Â  table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
Â  Â  Â  Â  th { text-align: center; padding: 10px 5px; color: var(--text-secondary); border-bottom: 1px solid var(--border); font-size: 0.75rem; }
Â  Â  Â  Â  td { padding: 12px 5px; border-bottom: 1px solid var(--border); color: var(--text-primary); text-align: center; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .badge { padding: 3px 6px; border-radius: 6px; font-size: 0.7rem; font-weight: bold; display: inline-block; white-space: nowrap; }
Â  Â  Â  Â  .st-green { background: var(--st-green-bg); color: var(--st-green-text); }
Â  Â  Â  Â  .st-yellow { background: var(--st-yellow-bg); color: var(--st-yellow-text); }
Â  Â  Â  Â  .st-red { background: var(--st-red-bg); color: var(--st-red-text); }

        /* =========================================
           ã€ä¿®æ”¹ã€‘æŒ‡æ®å®˜ç³»çµ±é¢¨æ ¼ - éœ“è™¹ç´…åˆªé™¤æŒ‰éµ
           ========================================= */
Â  Â  Â  Â  .btn-del-row {
            background: rgba(248, 113, 113, 0.15); /* åŠé€æ˜éœ“è™¹ç´…èƒŒæ™¯ */
            color: #f87171; /* éœ“è™¹ç´…æ–‡å­— */
            border: 1px solid rgba(248, 113, 113, 0.4); /* åŠé€æ˜é‚Šæ¡† */
            border-radius: 8px; /* è¼ƒåœ“æ½¤çš„é‚Šè§’ */
            padding: 6px 10px; /* å¢åŠ æŒ‰éˆ•å¤§å°èˆ‡é»æ“Šå€åŸŸ */
            font-size: 0.9rem; /* æ”¾å¤§ X ç¬¦è™Ÿ */
            font-weight: 800; /* åŠ ç²— X ç¬¦è™Ÿ */
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            /* å¾®å¼±çš„å¸¸é§éœ“è™¹å…‰æšˆ */
            box-shadow: 0 0 6px rgba(248, 113, 113, 0.2);
            line-height: 1; /* ç¢ºä¿å‚ç›´ç½®ä¸­ */
        }

        /* æ»‘é¼ æ‡¸åœæ•ˆæœ */
        .btn-del-row:hover {
            background: rgba(248, 113, 113, 0.3); /* èƒŒæ™¯è®Šäº® */
            border-color: #f87171; /* é‚Šæ¡†è®Šå¯¦å¿ƒ */
            box-shadow: 0 0 12px rgba(248, 113, 113, 0.5); /* å¢å¼·éœ“è™¹å…‰æšˆ */
            color: #fff; /* æ–‡å­—è®Šç™½ä»¥å¢åŠ å°æ¯” */
        }
        /* ========================================= */

Â  Â  Â  Â  /* HUD */
Â  Â  Â  Â  .summary-bar {Â 
Â  Â  Â  Â  Â  Â  position: fixed; bottom: 0; left: 0; right: 0;Â 
Â  Â  Â  Â  Â  Â  background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  border-top: 1px solid var(--border);
Â  Â  Â  Â  Â  Â  display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;
Â  Â  Â  Â  Â  Â  padding: 10px; z-index: 999;
Â  Â  Â  Â  }
Â  Â  Â  Â  .hud-item { border-radius: 8px; padding: 6px 4px; text-align: center; display: flex; flex-direction: column; justify-content: center; }
Â  Â  Â  Â  .hud-blue { background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.3); } .hud-blue .val { color: #60a5fa; }
Â  Â  Â  Â  .hud-orange { background: rgba(245, 158, 11, 0.15); border: 1px solid rgba(245, 158, 11, 0.3); } .hud-orange .val { color: #fbbf24; }
Â  Â  Â  Â  .hud-purple { background: rgba(168, 85, 247, 0.15); border: 1px solid rgba(168, 85, 247, 0.3); } .hud-purple .val { color: #c084fc; }
Â  Â  Â  Â  .hud-teal { background: rgba(20, 184, 166, 0.15); border: 1px solid rgba(20, 184, 166, 0.3); } .hud-teal .val { color: #2dd4bf; }

Â  Â  Â  Â  .label { font-size: 0.6rem; color: rgba(255,255,255,0.6); margin-bottom: 2px; }
Â  Â  Â  Â  .val { font-size: 0.9rem; font-weight: 800; font-family: monospace; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .action-bar { display: flex; gap: 10px; margin-top: 15px; }
Â  Â  Â  Â  .btn-act { flex: 1; padding: 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-input); color: var(--text-secondary); cursor: pointer; }
Â  Â  </style>
</head>
<body>

<h1>æ›œæ—¥ç¾½çƒï½œ<span>æ˜Ÿéš›è£œçµ¦æ¯è‰¦</span></h1>

<div class="card">
Â  Â  <h2>
Â  Â  Â  Â  1. é¸æ“‡æˆ–ç®¡ç†å ´åœ°
Â  Â  Â  Â  <span style="font-size:0.8rem; color:var(--accent); cursor:pointer;" onclick="toggleAddVenue()">ï¼‹æ–°å¢å ´æ¬¡</span>
Â  Â  </h2>
Â  Â  <input type="date" id="pickerDate" onchange="handleDateChange()">
Â  Â  <div id="dynamicVenueArea" class="venue-grid"></div>

Â  Â  <div id="addVenueForm">
Â  Â  Â  Â  <div style="display:flex; gap:15px; margin-bottom:10px; font-size:0.9rem;">
Â  Â  Â  Â  Â  Â  <label><input type="radio" name="vType" value="temp" checked> è‡¨æ™‚åŠ é–‹</label>
Â  Â  Â  Â  Â  Â  <label><input type="radio" name="vType" value="fixed"> å›ºå®šç­è¡¨</label>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <input type="text" id="nvName" class="form-input" placeholder="å ´åœ°åç¨± (å¦‚: å¤–èª¿æ¯”è³½)">
Â  Â  Â  Â  <div style="display:flex; gap:10px;">
Â  Â  Â  Â  Â  Â  <input type="number" id="nvCourt" class="form-input" placeholder="é¢æ•¸" value="1">
Â  Â  Â  Â  Â  Â  <input type="number" id="nvHr" class="form-input" placeholder="æ™‚æ•¸" value="2">
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button class="btn-save" style="margin-top:0; padding:10px;" onclick="confirmAddVenue()">ç¢ºå®šåŠ å…¥</button>
Â  Â  </div>

Â  Â  <div id="venueAdjustPanel">
Â  Â  Â  Â  <div class="adjust-header">
Â  Â  Â  Â  Â  Â  <span id="adjustTitle" class="adjust-title"></span>
Â  Â  Â  Â  Â  Â  <button id="btnEditToggle" class="btn-toggle-edit" onclick="toggleEditPanel()">âš™ï¸ èª¿æ•´è¦æ ¼</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="adjustContent">
Â  Â  Â  Â  Â  Â  <div class="adjust-row">
Â  Â  Â  Â  Â  Â  Â  Â  <span>é¢æ•¸</span>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="selCourt" class="form-select" onchange="updateFromSelect()"></select>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="adjust-row">
Â  Â  Â  Â  Â  Â  Â  Â  <span>æ™‚æ•¸</span>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="selHr" class="form-select" onchange="updateFromSelect()"></select>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div style="text-align:right; font-size:0.85rem; color:var(--text-secondary); margin-top:5px;">
Â  Â  Â  Â  Â  Â  Â  Â  ç¸½å ´æ™‚: <span id="dispTotalFH" style="color:var(--text-primary); font-weight:bold;">0</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="fixedVenueActions" class="manage-actions" style="display:none;">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-action btn-update" onclick="updateFixedVenue()">ğŸ’¾ æ›´æ–°é è¨­</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-action btn-delete" onclick="deleteFixedVenue()">ğŸ—‘ ç§»é™¤ç­è¡¨</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<div class="card">
Â  Â  <h2>
Â  Â  Â  Â  2. çƒç¨®æ¶ˆè€—
Â  Â  Â  Â  <span class="edit-toggle" onclick="toggleBallEdit()">ç·¨è¼¯æ¨¡å¼</span>
Â  Â  </h2>
Â  Â  <div id="ballArea" class="ball-grid"></div>

Â  Â  <div class="input-row">
Â  Â  Â  Â  <button class="adj-btn" onclick="adjCount(-1)">-</button>
Â  Â  Â  Â  <input type="number" id="inpCount" value="12">
Â  Â  Â  Â  <button class="adj-btn" onclick="adjCount(1)">+</button>
Â  Â  </div>
Â  Â Â 
Â  Â  <button class="btn-save" onclick="saveRecord()">å­˜å…¥ç´€éŒ„</button>
</div>

<div class="card">
Â  Â  <h2>3. æ­·å²ç´€éŒ„ (æœˆåº¦æˆ°æƒ…)</h2>
Â  Â  <div id="historyContainer"></div>
Â  Â  <div class="action-bar">
Â  Â  Â  Â  <button class="btn-act" onclick="exportData()" style="color:var(--success); border-color:var(--success);">åŒ¯å‡ºå ±è¡¨</button>
Â  Â  Â  Â  <button class="btn-act" onclick="clearData()" style="color:var(--danger); border-color:var(--danger);">æ¸…ç©ºè³‡æ–™</button>
Â  Â  </div>
</div>

<div class="summary-bar">
Â  Â  <div class="hud-item hud-blue"><div class="label">ç¸½æˆæœ¬</div><div class="val" id="footCost">$0</div></div>
Â  Â  <div class="hud-item hud-orange"><div class="label">ç¸½è€—çƒ</div><div class="val" id="footBall">0</div></div>
Â  Â  <div class="hud-item hud-purple"><div class="label">CPCH</div><div class="val" id="footCPCH">0.0</div></div>
Â  Â  <div class="hud-item hud-teal"><div class="label">$/HR</div><div class="val" id="footAvgCost">0</div></div>
</div>

<script>
Â  Â  const defaultScheduleRaw = {
Â  Â  Â  Â  1: [{ id:1, name: 'æœˆæ›œå—æ¸¯', court: 2, hr: 2 }, { id:2, name: 'æœˆæ›œä¸­å£¢', court: 4, hr: 2 }],
Â  Â  Â  Â  2: [{ id:3, name: 'ç«æ›œå¤ªå¹³', court: 3, hr: 2 }],
Â  Â  Â  Â  3: [{ id:4, name: 'æ°´æ›œä¸ƒä¸ƒ', court: 3, hr: 2 }, { id:5, name: 'æ°´æ›œäºŒé‡', court: 4, hr: 2 }],
Â  Â  Â  Â  4: [{ id:6, name: 'æœ¨æ›œå¤§åŒ', court: 4, hr: 2 }],
Â  Â  Â  Â  5: [],
Â  Â  Â  Â  6: [{ id:7, name: 'åœŸæ›œèˆˆé›…', court: 11, hr: 2 }],
Â  Â  Â  Â  0: [{ id:8, name: 'æ—¥æ›œä¸­æ­£', court: 2, hr: 2 }]
Â  Â  };

Â  Â  let schedule = JSON.parse(localStorage.getItem('yao_schedule_v9')) || defaultScheduleRaw;
Â  Â  let balls = JSON.parse(localStorage.getItem('yao_balls_v9')) || [
Â  Â  Â  Â  {name:'é»‘é­”äº', price:67}, {name:'è—è“‹', price:75}, {name:'Master', price:92}
Â  Â  ];
Â  Â  let records = JSON.parse(localStorage.getItem('yao_records_v9')) || [];
Â  Â Â 
Â  Â  let currentVenue = null;Â 
Â  Â  let selectedBall = null;
Â  Â  let isBallEditMode = false;

Â  Â  function initSelects() {
Â  Â  Â  Â  const selCourt = document.getElementById('selCourt');
Â  Â  Â  Â  const selHr = document.getElementById('selHr');
Â  Â  Â  Â  for(let i=1; i<=16; i++) selCourt.innerHTML += `<option value="${i}">${i} é¢</option>`;
Â  Â  Â  Â  for(let i=0.5; i<=8.0; i+=0.5) selHr.innerHTML += `<option value="${i}">${i} å°æ™‚</option>`;
Â  Â  }

Â  Â  window.onload = function() {
Â  Â  Â  Â  initSelects();
Â  Â  Â  Â  document.getElementById('pickerDate').value = new Date().toISOString().split('T')[0];
Â  Â  Â  Â  handleDateChange();
Â  Â  Â  Â  renderBalls();
Â  Â  Â  Â  refreshUI();
Â  Â  };

Â  Â  // === æ—¥æœŸèˆ‡å ´åœ° ===
Â  Â  function handleDateChange() {
Â  Â  Â  Â  const dateVal = document.getElementById('pickerDate').value;
Â  Â  Â  Â  if (!dateVal) return;
Â  Â  Â  Â  const dayIndex = new Date(dateVal).getDay();Â 
Â  Â  Â  Â  renderVenueGrid(dayIndex);
Â  Â  }

Â  Â  function renderVenueGrid(dayIndex) {
Â  Â  Â  Â  const container = document.getElementById('dynamicVenueArea');
Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  currentVenue = null;
Â  Â  Â  Â  document.getElementById('venueAdjustPanel').style.display = 'none';
Â  Â  Â  Â  document.getElementById('addVenueForm').style.display = 'none';

Â  Â  Â  Â  const venues = schedule[dayIndex] || [];
Â  Â  Â  Â  if (venues.length > 0) {
Â  Â  Â  Â  Â  Â  venues.forEach(v => {
Â  Â  Â  Â  Â  Â  Â  Â  const btn = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  btn.className = `venue-btn day-${dayIndex}`; // ç¶å®šè©²æ—¥æœŸçš„é¡è‰²
Â  Â  Â  Â  Â  Â  Â  Â  btn.innerHTML = `<strong>${v.name}</strong><span>${v.court}é¢ / ${v.hr}hr</span>`;
Â  Â  Â  Â  Â  Â  Â  Â  btn.onclick = () => selectVenue(v, btn, dayIndex);
Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(btn);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  container.innerHTML = `<div style="grid-column:span 2; text-align:center; color:var(--text-secondary); padding:10px;">æœ¬æ—¥ç„¡å›ºå®šç­è¡¨</div>`;
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function selectVenue(v, el, dayIndex) {
Â  Â  Â  Â  currentVenue = { ...v, dayIndex: dayIndex };Â 
Â  Â  Â  Â  document.querySelectorAll('.venue-btn').forEach(b => b.classList.remove('active'));
Â  Â  Â  Â  if(el) el.classList.add('active');

Â  Â  Â  Â  document.getElementById('venueAdjustPanel').style.display = 'block';
Â  Â  Â  Â  document.getElementById('adjustTitle').innerText = currentVenue.name;
Â  Â  Â  Â  document.getElementById('fixedVenueActions').style.display = currentVenue.id ? 'flex' : 'none';
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('adjustContent').style.display = 'none';
Â  Â  Â  Â  document.getElementById('btnEditToggle').classList.remove('active');

Â  Â  Â  Â  document.getElementById('selCourt').value = currentVenue.court;
Â  Â  Â  Â  document.getElementById('selHr').value = currentVenue.hr;
Â  Â  Â  Â  updateFromSelect();
Â  Â  Â  Â  document.getElementById('addVenueForm').style.display = 'none';
Â  Â  }

Â  Â  function toggleEditPanel() {
Â  Â  Â  Â  const content = document.getElementById('adjustContent');
Â  Â  Â  Â  const btn = document.getElementById('btnEditToggle');
Â  Â  Â  Â  if(content.style.display === 'none' || content.style.display === '') {
Â  Â  Â  Â  Â  Â  content.style.display = 'block'; btn.classList.add('active');
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  content.style.display = 'none'; btn.classList.remove('active');
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function updateFromSelect() {
Â  Â  Â  Â  if(!currentVenue) return;
Â  Â  Â  Â  const c = parseFloat(document.getElementById('selCourt').value);
Â  Â  Â  Â  const h = parseFloat(document.getElementById('selHr').value);
Â  Â  Â  Â  currentVenue.court = c; currentVenue.hr = h;
Â  Â  Â  Â  document.getElementById('dispTotalFH').innerText = (c * h).toFixed(1);
Â  Â  }

Â  Â  // === æ–°å¢/åˆªé™¤å ´åœ° ===
Â  Â  function toggleAddVenue() {
Â  Â  Â  Â  const form = document.getElementById('addVenueForm');
Â  Â  Â  Â  form.style.display = form.style.display === 'none' ? 'block' : 'none';
Â  Â  Â  Â  document.getElementById('venueAdjustPanel').style.display = 'none';
Â  Â  Â  Â  document.querySelectorAll('.venue-btn').forEach(b => b.classList.remove('active'));
Â  Â  Â  Â  currentVenue = null;
Â  Â  }

Â  Â  function confirmAddVenue() {
Â  Â  Â  Â  const name = document.getElementById('nvName').value;
Â  Â  Â  Â  const court = parseFloat(document.getElementById('nvCourt').value);
Â  Â  Â  Â  const hr = parseFloat(document.getElementById('nvHr').value);
Â  Â  Â  Â  const type = document.querySelector('input[name="vType"]:checked').value;
Â  Â  Â  Â  if(!name) return alert("è«‹è¼¸å…¥åç¨±");

Â  Â  Â  Â  if(type === 'fixed') {
Â  Â  Â  Â  Â  Â  const dateVal = document.getElementById('pickerDate').value;
Â  Â  Â  Â  Â  Â  const dayIndex = new Date(dateVal).getDay();
Â  Â  Â  Â  Â  Â  if(!schedule[dayIndex]) schedule[dayIndex] = [];
Â  Â  Â  Â  Â  Â  schedule[dayIndex].push({ id: Date.now(), name, court, hr });
Â  Â  Â  Â  Â  Â  localStorage.setItem('yao_schedule_v9', JSON.stringify(schedule));
Â  Â  Â  Â  Â  Â  handleDateChange();
Â  Â  Â  Â  Â  Â  alert("å·²åŠ å…¥ç­è¡¨");
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  currentVenue = { name, court, hr, cid: 'temp' };
Â  Â  Â  Â  Â  Â  document.getElementById('addVenueForm').style.display = 'none';
Â  Â  Â  Â  Â  Â  document.getElementById('venueAdjustPanel').style.display = 'block';
Â  Â  Â  Â  Â  Â  document.getElementById('adjustTitle').innerText = name + " (è‡¨æ™‚)";
Â  Â  Â  Â  Â  Â  document.getElementById('fixedVenueActions').style.display = 'none';
Â  Â  Â  Â  Â  Â  document.getElementById('adjustContent').style.display = 'block';Â 
Â  Â  Â  Â  Â  Â  document.getElementById('selCourt').value = court;
Â  Â  Â  Â  Â  Â  document.getElementById('selHr').value = hr;
Â  Â  Â  Â  Â  Â  updateFromSelect();
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function updateFixedVenue() {
Â  Â  Â  Â  if(!currentVenue.id) return;
Â  Â  Â  Â  const d = currentVenue.dayIndex;
Â  Â  Â  Â  const idx = schedule[d].findIndex(v => v.id === currentVenue.id);
Â  Â  Â  Â  if(idx!==-1) {
Â  Â  Â  Â  Â  Â  schedule[d][idx].court = currentVenue.court;
Â  Â  Â  Â  Â  Â  schedule[d][idx].hr = currentVenue.hr;
Â  Â  Â  Â  Â  Â  localStorage.setItem('yao_schedule_v9', JSON.stringify(schedule));
Â  Â  Â  Â  Â  Â  alert("ç­è¡¨æ›´æ–°ï¼"); handleDateChange();
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function deleteFixedVenue() {
Â  Â  Â  Â  if(!currentVenue.id) return;
Â  Â  Â  Â  if(!confirm(`ç§»é™¤ã€${currentVenue.name}ã€‘ï¼Ÿ`)) return;
Â  Â  Â  Â  const d = currentVenue.dayIndex;
Â  Â  Â  Â  schedule[d] = schedule[d].filter(v => v.id !== currentVenue.id);
Â  Â  Â  Â  localStorage.setItem('yao_schedule_v9', JSON.stringify(schedule));
Â  Â  Â  Â  handleDateChange();
Â  Â  }

Â  Â  // === çƒç¨® ===
Â  Â  function toggleBallEdit() { isBallEditMode = !isBallEditMode; renderBalls(); }
Â  Â  function renderBalls() {
Â  Â  Â  Â  const container = document.getElementById('ballArea'); container.innerHTML = '';
Â  Â  Â  Â  balls.forEach((b, idx) => {
Â  Â  Â  Â  Â  Â  const btn = document.createElement('div');
Â  Â  Â  Â  Â  Â  btn.className = 'ball-btn'; btn.innerText = `${b.name} $${b.price}`;
Â  Â  Â  Â  Â  Â  if(isBallEditMode) {
Â  Â  Â  Â  Â  Â  Â  Â  const delIcon = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  delIcon.className = 'ball-del-btn'; delIcon.innerText = 'Ã—';
Â  Â  Â  Â  Â  Â  Â  Â  delIcon.onclick = (e) => { e.stopPropagation(); deleteBall(idx); };
Â  Â  Â  Â  Â  Â  Â  Â  btn.appendChild(delIcon); btn.style.borderColor = 'var(--danger)';
Â  Â  Â  Â  Â  Â  } else { btn.onclick = () => selectBall(b, btn); }
Â  Â  Â  Â  Â  Â  container.appendChild(btn);
Â  Â  Â  Â  });
Â  Â  Â  Â  const addBtn = document.createElement('div');
Â  Â  Â  Â  addBtn.className = 'ball-btn'; addBtn.style.border = '1px dashed #94a3b8'; addBtn.innerText = 'ï¼‹ æ–°å¢';
Â  Â  Â  Â  addBtn.onclick = addNewBall; container.appendChild(addBtn);
Â  Â  }
Â  Â  function addNewBall() {
Â  Â  Â  Â  const name = prompt("åç¨±:"); if(!name) return;
Â  Â  Â  Â  const price = prompt("å–®åƒ¹:"); if(!price) return;
Â  Â  Â  Â  balls.push({name, price:parseFloat(price)}); localStorage.setItem('yao_balls_v9', JSON.stringify(balls)); renderBalls();
Â  Â  }
Â  Â  function deleteBall(idx) { if(!confirm("åˆªé™¤ï¼Ÿ")) return; balls.splice(idx, 1); localStorage.setItem('yao_balls_v9', JSON.stringify(balls)); renderBalls(); }
Â  Â  function selectBall(b, el) { selectedBall = b; document.querySelectorAll('.ball-btn').forEach(btn => btn.classList.remove('active')); el.classList.add('active'); }
Â  Â  function adjCount(n) { const el = document.getElementById('inpCount'); el.value = Math.max(0, (parseInt(el.value)||0) + n); }

Â  Â  // === å­˜æª” ===
Â  Â  function saveRecord() {
Â  Â  Â  Â  if (!currentVenue) return alert("è«‹é¸æ“‡å ´åœ°");
Â  Â  Â  Â  if (!selectedBall) return alert("è«‹é¸æ“‡çƒç¨®");
Â  Â  Â  Â Â 
Â  Â  Â  Â  const dateVal = document.getElementById('pickerDate').value;
Â  Â  Â  Â  const count = parseFloat(document.getElementById('inpCount').value) || 0;
Â  Â  Â  Â  const cost = selectedBall.price * count;
Â  Â  Â  Â  const fh = currentVenue.court * currentVenue.hr;
Â  Â  Â  Â  const dayIdx = new Date(dateVal).getDay();

Â  Â  Â  Â  const record = {
Â  Â  Â  Â  Â  Â  id: Date.now(), date: dateVal, vName: currentVenue.name, dayIdx: dayIdx,
Â  Â  Â  Â  Â  Â  fh: fh, bName: selectedBall.name, count: count, cost: cost
Â  Â  Â  Â  };

Â  Â  Â  Â  const existIdx = records.findIndex(r => r.date === dateVal && r.vName === currentVenue.name);
Â  Â  Â  Â  if(existIdx !== -1) {
Â  Â  Â  Â  Â  Â  if(!confirm("å·²æœ‰ç´€éŒ„ï¼Œè¦†è“‹ï¼Ÿ")) return;
Â  Â  Â  Â  Â  Â  records[existIdx] = { ...record, id: records[existIdx].id };
Â  Â  Â  Â  } else { records.push(record); }

Â  Â  Â  Â  localStorage.setItem('yao_records_v9', JSON.stringify(records));
Â  Â  Â  Â  refreshUI(); alert("å­˜æª”æˆåŠŸ");
Â  Â  }

Â  Â  // === æ­·å²èˆ‡å ±è¡¨ (å…¨åŸŸå…‰è­œç‰ˆ) ===
Â  Â  function refreshUI() {
Â  Â  Â  Â  records.sort((a, b) => new Date(b.date) - new Date(a.date));
Â  Â  Â  Â  let tCost=0, tBall=0, tFH=0;
Â  Â  Â  Â  const grouped = {};

Â  Â  Â  Â  records.forEach(r => {
Â  Â  Â  Â  Â  Â  tCost += r.cost; tBall += r.count; tFH += r.fh;
Â  Â  Â  Â  Â  Â  if(!grouped[r.vName]) {
Â  Â  Â  Â  Â  Â  Â  Â  grouped[r.vName] = { list: [], total: 0, dayIdx: r.dayIdx, monthly: {} };
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  grouped[r.vName].list.push(r);
Â  Â  Â  Â  Â  Â  grouped[r.vName].total += r.cost;

Â  Â  Â  Â  Â  Â  const mKey = r.date.slice(0, 7);Â 
Â  Â  Â  Â  Â  Â  if(!grouped[r.vName].monthly[mKey]) grouped[r.vName].monthly[mKey] = { count: 0, cost: 0, fh: 0 };
Â  Â  Â  Â  Â  Â  grouped[r.vName].monthly[mKey].count += r.count;
Â  Â  Â  Â  Â  Â  grouped[r.vName].monthly[mKey].cost += r.cost;
Â  Â  Â  Â  Â  Â  grouped[r.vName].monthly[mKey].fh += r.fh;
Â  Â  Â  Â  });

Â  Â  Â  Â  const container = document.getElementById('historyContainer');
Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â Â 
Â  Â  Â  Â  Object.keys(grouped).forEach(vName => {
Â  Â  Â  Â  Â  Â  const g = grouped[vName];
Â  Â  Â  Â  Â  Â  const cls = g.dayIdx !== undefined ? `day-${g.dayIdx}` : 'day-temp';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // æœˆåº¦å¡ç‰‡ (æœˆä»½è¼ƒå°åœ¨å·¦é‚Š)
Â  Â  Â  Â  Â  Â  let monthHtml = '';
Â  Â  Â  Â  Â  Â  Object.keys(g.monthly).sort().forEach(m => {Â  // Remove .reverse() here
Â  Â  Â  Â  Â  Â  Â  Â  const md = g.monthly[m];
Â  Â  Â  Â  Â  Â  Â  Â  const m_avg = md.fh > 0 ? Math.round(md.cost / md.fh) : 0;
Â  Â  Â  Â  Â  Â  Â  Â  monthHtml += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="month-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="mc-header">${m}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="mc-row"><span class="mc-label">è€—çƒ</span><span class="mc-val" style="color:var(--accent)">${md.count}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="mc-row"><span class="mc-label">é–‹éŠ·</span><span class="mc-val">$${md.cost}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="mc-row"><span class="mc-label">å‡/hr</span><span class="mc-val">$${m_avg}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  const html = `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="venue-group ${cls}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="group-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="gh-title">${vName}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>$${Math.round(g.total).toLocaleString()}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="month-dashboard">${monthHtml}</div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th>æ—¥æœŸ</th><th>è€—çƒ</th><th>CPCH</th><th>$/FH</th><th>åˆª</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${g.list.map(i => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const cpch = i.fh > 0 ? (i.count/i.fh).toFixed(2) : 0;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const costPerFH = i.fh > 0 ? Math.round(i.cost / i.fh) : 0;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let b = 'st-green', t='æ¥µçœ';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(cpch > 4.0){ b='st-red'; t='éè¼‰'; }Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if(cpch >= 2.5){ b='st-yellow'; t='æ­£å¸¸'; }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `<tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${i.date.slice(5)}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${i.count}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><span class="badge ${b}">${t} ${cpch}</span></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td style="color:var(--text-secondary);">$${costPerFH}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><button class="btn-del-row" onclick="delRecord(${i.id})">Ã—</button></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }).join('')}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  Â  Â  container.innerHTML += html;
Â  Â  Â  Â  });

Â  Â  Â  Â  document.getElementById('footCost').innerText = "$"+Math.round(tCost).toLocaleString();
Â  Â  Â  Â  document.getElementById('footBall').innerText = tBall;
Â  Â  Â  Â  document.getElementById('footCPCH').innerText = tFH>0 ? (tBall/tFH).toFixed(2) : "0.0";
Â  Â  Â  Â  document.getElementById('footAvgCost').innerText = "$" + (tFH>0 ? Math.round(tCost/tFH) : 0);
Â  Â  }

Â  Â  function delRecord(id){ if(confirm("åˆªé™¤ï¼Ÿ")){ records=records.filter(r=>r.id!==id); localStorage.setItem('yao_records_v9',JSON.stringify(records)); refreshUI(); } }
Â  Â  function clearData(){ if(confirm("æ¸…ç©ºï¼Ÿ")){ records=[]; localStorage.setItem('yao_records_v9',JSON.stringify(records)); refreshUI(); } }
Â  Â  function exportData() {
Â  Â  Â  Â  if(records.length===0) return alert("ç„¡è³‡æ–™");
Â  Â  Â  Â  let csv = "\uFEFFæ—¥æœŸ,å ´åœ°,çƒç¨®,å ´æ™‚,è€—çƒ,ç¸½é‡‘é¡,CPCH,æ¯å ´æ™‚æˆæœ¬($/FH),ç‹€æ…‹\n";
Â  Â  Â  Â  records.forEach(r => {
Â  Â  Â  Â  Â  Â  const cpch = r.fh>0 ? (r.count/r.fh).toFixed(2) : 0;
Â  Â  Â  Â  Â  Â  const costPerFH = r.fh>0 ? Math.round(r.cost/r.fh) : 0;
Â  Â  Â  Â  Â  Â  let st = cpch > 4 ? "éè¼‰" : (cpch >= 2.5 ? "æ­£å¸¸" : "æ¥µçœ");
Â  Â  Â  Â  Â  Â  csv += `${r.date},${r.vName},${r.bName},${r.fh},${r.count},${r.cost},${cpch},${costPerFH},${st}\n`;
Â  Â  Â  Â  });
Â  Â  Â  Â  const url = URL.createObjectURL(new Blob([csv], {type:'text/csv'}));
Â  Â  Â  Â  const a = document.createElement('a'); a.href=url; a.download=`æ›œæ—¥å ±è¡¨_${new Date().toISOString().slice(0,10)}.csv`; a.click();
Â  Â  }
</script>
</body>
</html>
